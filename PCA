library(FactoMineR)
library(factoextra)

#Decidere il numero di componenti da conservare:
##Mostra quanta varianza spiega ciascuna componente. Guardi dove il grafico "si appiattisce", cio√® il cosiddetto "gomito" (elbow).
res.pca <- PCA(Database_analisi_R, scale.unit = TRUE, quali.sup = c(1:7, 26:29), graph = FALSE)
fviz_eig(res.pca)

#Mostra la varianza spiegata e comulativa: scelgo le prime componenti che spiegano almeno i l70% della varianza totale, quindi 10
res.pca$eig  

#PCA
PCA<- PCA(Database_analisi_R, scale.unit = TRUE, graph=FALSE, ncp=10, quali.sup=c(1:7, 26:29))
# X: the data set used. Rows are individuals and columns are numeric variables.
# scale.unit: if TRUE, the data are scaled to unit variance before the analysis.
# ncp: number of PCs to keep.
# graph: if TRUE, the graphs are displayed

## The attribute eig contains information relative to the variance explained in each component.
eig <- get_eig(PCA)

## Plot the % of variances explained by each PC
fviz_screeplot(PCA, addlabels = TRUE)

## Extract the data associated with the observations from the pca object
ind <- get_pca_ind(PCA)
ind

#Plot of the samples onto the space spanned by the first and the second PCs.
## Color the data points according to type of recipe
plot.PCA(PCA, axes = c(1,2), choix = 'ind', habillage = 2, invisible = 'quali')
